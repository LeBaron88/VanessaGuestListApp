{"ast":null,"code":"\"use strict\";\n\nlet fileUtils = require(\"././util/fileUtils\");\n\nlet stringUtils = require(\"././util/stringUtils\");\n\nlet jsonUtils = require(\"././util/jsonUtils\");\n\nconst newLine = /\\r?\\n/;\nconst defaultFieldDelimiter = \";\";\n\nclass CsvToJson {\n  formatValueByType() {\n    this.printValueFormatByType = true;\n    return this;\n  }\n\n  fieldDelimiter(delimieter) {\n    this.delimiter = delimieter;\n    return this;\n  }\n\n  generateJsonFileFromCsv(fileInputName, fileOutputName) {\n    let jsonStringified = this.getJsonFromCsvStringified(fileInputName);\n    fileUtils.writeFile(jsonStringified, fileOutputName);\n  }\n\n  getJsonFromCsvStringified(fileInputName) {\n    let json = this.getJsonFromCsv(fileInputName);\n    let jsonStringified = JSON.stringify(json, undefined, 1);\n    jsonUtils.validateJson(jsonStringified);\n    return jsonStringified;\n  }\n\n  getJsonFromCsv(fileInputName) {\n    let parsedCsv = fileUtils.readFile(fileInputName);\n    return this.csvToJson(parsedCsv);\n  }\n\n  csvStringToJson(csvString) {\n    return this.csvToJson(csvString);\n  }\n\n  csvToJson(parsedCsv) {\n    let lines = parsedCsv.split(newLine);\n    let fieldDelimiter = this.getFieldDelimiter();\n    let headers = lines[0].split(fieldDelimiter);\n    let jsonResult = [];\n\n    for (let i = 1; i < lines.length; i++) {\n      let currentLine = lines[i].split(fieldDelimiter);\n\n      if (stringUtils.hasContent(currentLine)) {\n        jsonResult.push(this.buildJsonResult(headers, currentLine));\n      }\n    }\n\n    return jsonResult;\n  }\n\n  getFieldDelimiter() {\n    if (this.delimiter) {\n      return this.delimiter;\n    }\n\n    return defaultFieldDelimiter;\n  }\n\n  buildJsonResult(headers, currentLine) {\n    let jsonObject = {};\n\n    for (let j = 0; j < headers.length; j++) {\n      let propertyName = stringUtils.trimPropertyName(headers[j]);\n      let value = currentLine[j];\n\n      if (this.printValueFormatByType) {\n        value = stringUtils.getValueFormatByType(currentLine[j]);\n      }\n\n      jsonObject[propertyName] = value;\n    }\n\n    return jsonObject;\n  }\n\n}\n\nmodule.exports = new CsvToJson();","map":null,"metadata":{},"sourceType":"script"}